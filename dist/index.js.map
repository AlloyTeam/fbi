{"version":3,"sources":["../src/index.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAAA;;;;AAEA;;;;AACA;;IAAY,C;;AAEZ;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;;;AAEA,IAAM,WAAW,CACf;AACE,QAAM,QADR;AAEE,SAAO,IAFT;AAGE;AAHF,CADe,EAMf;AACE,QAAM,WADR;AAEE,SAAO,IAFT;AAGE;AAHF,CANe,EAWf;AACE,QAAM,KADR;AAEE,SAAO,GAFT;AAGE;AAHF,CAXe,EAgBf;AACE,QAAM,OADR;AAEE,SAAO,GAFT;AAGE;AAHF,CAhBe,EAqBf;AACE,QAAM,OADR;AAEE,SAAO,GAFT;AAGE;AAHF,CArBe,CAAjB;AAPA;;AAHA;;;IAsCM,G;AAEJ,iBAAe;AAAA;;AACb,SAAK,CAAL,GAAS,CAAT;AACA,SAAK,GAAL;AACA,SAAK,IAAL;AACA,SAAK,KAAL,GAAa,EAAb;;AAEA;AACA;AACA;AACA;AACA,SAAK,IAAL;AACA,SAAK,OAAL,CAAa,QAAb;AACD;;;;wBAEI,K,EAAO;AAAA;;AACV,UAAI,OAAO,EAAX;AACA,UAAI,CAAC,MAAM,MAAX,EAAmB;AACjB,aAAK,IAAL,CAAU,IAAV;AACA;AACD;;AAED,UAAI,OAAO,KAAP,KAAiB,QAArB,EAA+B;AAC7B,aAAK,IAAL,CAAU,KAAV;AACD,OAFD,MAEO;AACL,eAAO,KAAP;AACD;;AAED,UAAM,YAAY,CAAC,IAAD,EAAO,QAAP,EAAiB,IAAjB,EAAuB,WAAvB,CAAlB,CAAsD;;AAb5C;AAAA;AAAA;;AAAA;AAAA;AAAA,cAeD,GAfC;;AAgBR,gBAAK,KAAL,CAAW,GAAX,CAAe,gBAAQ;AACrB,gBAAI,QAAQ,KAAK,IAAb,IAAqB,QAAQ,KAAK,KAAtC,EAA6C;AAC3C,kBAAI,CAAC,UAAU,QAAV,CAAmB,KAAK,IAAxB,CAAD,IAAkC,CAAC,UAAU,QAAV,CAAmB,KAAK,KAAxB,CAAvC,EAAuE;AACrE,wBAAQ,GAAR,qBAA6B,KAAK,IAAlC;AACD;AACD,mBAAK,EAAL;AACD;AACF,WAPD;AAhBQ;;AAeV,wDAAgB,IAAhB,4GAAsB;AAAA;AASrB;AAxBS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAyBX;;;2BAEO;AACN;AACA;AACA,UAAI;AACF,YAAI,QAAQ,KAAK,CAAL,CAAO,GAAP,CAAW,KAAK,GAAL,CAAS,KAAT,CAAe,OAA1B,CAAZ;AACA,qBAAG,UAAH,CAAc,KAAd,EAAqB,aAAG,IAAH,GAAU,aAAG,IAAlC;AACA,aAAK,KAAL,GAAa,IAAb;AACA,YAAI,SAAS,QAAQ,KAAR,CAAb;AACA,aAAK,CAAL,CAAO,KAAP,CAAa,KAAK,GAAlB,EAAuB,MAAvB;AACD,OAND,CAME,OAAM,CAAN,EAAS;AACT,aAAK,KAAL,GAAa,KAAb;AACD;AACF;;;4BAEQ,I,EAAM;AACb,UAAI,MAAM,OAAN,CAAc,IAAd,CAAJ,EAAyB;AACvB,aAAK,KAAL,GAAa,KAAK,KAAL,CAAW,MAAX,CAAkB,IAAlB,CAAb;AACD,OAFD,MAEO;AACL,aAAK,KAAL,CAAW,IAAX,CAAgB,IAAhB;AACD;AACF;;;;;kBAIY,G","file":"index.js","sourcesContent":["import fs from 'fs'\n// fbi assets\nimport config from './config'\nimport * as _ from './utils'\n// fbi tasks\nimport help from './tasks/help'\nimport create from './tasks/create'\nimport serve from './tasks/serve'\nimport build from './tasks/build'\nimport version from './tasks/version'\n\nconst defTasks = [\n  {\n    name: '--help',\n    short: '-h',\n    fn: help\n  },\n  {\n    name: '--version',\n    short: '-v',\n    fn: version\n  },\n  {\n    name: 'new',\n    short: 'n',\n    fn: create\n  },\n  {\n    name: 'build',\n    short: 'b',\n    fn: build\n  },\n  {\n    name: 'serve',\n    short: 's',\n    fn: serve\n  }\n]\n\nclass Fbi {\n\n  constructor () {\n    this._ = _\n    this.cfg = config\n    this.help = help\n    this.tasks = []\n\n    // (async function() {\n    //   console.log('async in')\n    //   await _this.mergeCfg()\n    // }())\n    this.init()\n    this.addTask(defTasks)\n  }\n\n  run (argvs) {\n    let cmds = []\n    if (!argvs.length) {\n      this.help(this)\n      return\n    }\n\n    if (typeof argvs === 'string') {\n      cmds.push(argvs)\n    } else {\n      cmds = argvs\n    }\n\n    const utilTasks = ['-h', '--help', '-v', '--verison'] // don't log\n\n    for (let cmd of cmds) {\n      this.tasks.map(task => {\n        if (cmd === task.name || cmd === task.short) {\n          if (!utilTasks.includes(task.name) && !utilTasks.includes(task.short)) {\n            console.log(`Running task '${task.name}'`)\n          }\n          task.fn(this)\n        }\n      })\n    }\n  }\n\n  init () {\n    // is fbi or not\n    // get user config\n    try {\n      let _path = this._.cwd(this.cfg.paths.options)\n      fs.accessSync(_path, fs.R_OK | fs.W_OK)\n      this.isFbi = true\n      let usrCfg = require(_path)\n      this._.merge(this.cfg, usrCfg)\n    } catch(e) {\n      this.isFbi = false\n    }\n  }\n\n  addTask (task) {\n    if (Array.isArray(task)) {\n      this.tasks = this.tasks.concat(task)\n    } else {\n      this.tasks.push(task)\n    }\n  }\n\n}\n\nexport default Fbi\n"]}