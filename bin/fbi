#!/usr/bin/env node

'use strict'

process.on('unhandledRejection', error => {
  console.log(error)
  process.exit(1)
})

checkNodeVersion()

const Cli = require('../lib/cli')
const cli = new Cli()
cli.init(process.argv.slice(2))

function checkNodeVersion () {
  const style = require('../lib/utils/style')
  const pkg = require('../package.json')

  const targets = [8, 2]
  const version = process.versions.node.match(/(.*)\./)[1]
  const versions = version.split('.').map(str => str * 1)

  if (
    versions[0] < targets[0] ||
    (versions[0] === targets[0] && versions[1] < targets[1])
  ) {
    console.log(
      style.red(
        `Error: fbi ${pkg.version} requires Node.js v${targets.join(
          '.'
        )} or higher (you have v${version}).`
      )
    )
    process.exit(1)
  }
}
